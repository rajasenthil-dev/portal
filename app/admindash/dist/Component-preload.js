//@ui5-bundle admindash/Component-preload.js
sap.ui.require.preload({
	"admindash/Component.js":function(){
sap.ui.define(["sap/ui/core/UIComponent","admindash/model/models"],(e,t)=>{"use strict";return e.extend("admindash.Component",{metadata:{manifest:"json",interfaces:["sap.ui.core.IAsyncContentCreation"]},init(){e.prototype.init.apply(this,arguments);this.setModel(t.createDeviceModel(),"device");this.getRouter().initialize()}})});
},
	"admindash/controller/App.controller.js":function(){
sap.ui.define(["sap/ui/core/mvc/Controller"],e=>{"use strict";return e.extend("admindash.controller.App",{onInit(){}})});
},
	"admindash/controller/View1.controller.js":function(){
sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ui/core/format/FileSizeFormat","sap/m/MessageBox"],function(e,t,r,i,a){"use strict";return e.extend("admindash.controller.View1",{onInit:function(){this.oUploadSet=this.byId("fileUploader");this._oModel=this.getOwnerComponent().getModel();this.getView().setModel(new r({fileData:null,csrfToken:null,manufacturerNumber:"",mfgName:"",existingManufacturers:[],existingMfgNames:[]}),"ui");this._binding=null;this.getView().getModel("ui").setProperty("/isEditMode",true);this._fetchExistingManufacturers()},onBeforeRendering:function(){this._fetchCSRFToken()},_fetchExistingManufacturers:function(){var e=sap.ui.require.toUrl("admindash").split("/resources")[0];if(e==="."){e=""}return fetch(e+"/odata/v4/media/MediaFile").then(e=>e.json()).then(e=>{var t=e.value.map(e=>e.manufacturerNumber);var r=e.value.map(e=>e.MFGName);this.getView().getModel("ui").setProperty("/existingManufacturers",t);this.getView().getModel("ui").setProperty("/existingMfgNames",r)}).catch(e=>console.error("Error fetching manufacturers:",e))},onChange:function(e){var t=e.getParameter("files")?.[0];var r=this.getView().getModel("ui");if(t){r.setProperty("/fileData",{file:t,fileName:t.name,fileSize:i.getInstance({binaryFilesize:false,maxFractionDigits:1,maxIntegerDigits:3}).format(t.size),fileType:t.type})}else{r.setProperty("/fileData",null)}},onOpenDialog:function(){const e=this.getView().getModel("ui");e.setProperty("/isEditMode",false);this.getView().byId("addManufacturerDialog").open()},onEditPress:function(){const e=this.byId("idMediaFilesTable");const t=e.getSelectedItems();if(t.length!==1){a.warning("Please select exactly one file to edit.");return}const r=t[0].getBindingContext();const i=r.getObject();const n=this.getView().getModel("ui");n.setProperty("/isEditMode",true);n.setProperty("/manufacturerNumber",i.manufacturerNumber);n.setProperty("/mfgName",i.MFGName);n.setProperty("/fileData",{fileName:i.fileName,fileType:i.mediaType,fileUrl:i.url});this._editBindingContext=r;this.getView().byId("addManufacturerDialog").open()},onCloseDialog:function(){this.getView().byId("addManufacturerDialog").close()},onUploadPress:async function(){const e=!!this._editBindingContext;const t=this.getView().getModel("ui");const r=t.getProperty("/fileData/file");const i=t.getProperty("/manufacturerNumber");const n=t.getProperty("/mfgName");const o=t.getProperty("/csrfToken");const s=t.getProperty("/existingManufacturers").map(e=>e.toLowerCase());const l=t.getProperty("/existingMfgNames").map(e=>e.toLowerCase());const u=e?this._editBindingContext.getProperty("manufacturerNumber").toLowerCase():null;const c=e?this._editBindingContext.getProperty("MFGName").toLowerCase():null;if(s.includes(i.toLowerCase())&&(!e||i.toLowerCase()!==u)){a.error("This Manufacturer Number already exists.");return}if(l.includes(n.toLowerCase())&&(!e||n.toLowerCase()!==c)){a.error("This Manufacturer Name already exists.");return}if(!this._validateUploadInputs(i,n,r,e))return;try{if(!this._binding){if(e){this._binding=this.getView().getModel().bindContext(this._editBindingContext.getPath(),null,{$$updateGroupId:"UploadGroup"})}else{const e=await this._createDraft(i,n,r.name,r.type,o);if(e?.context){this._binding=this.getView().getModel().bindContext(e.context.getPath(),null,{$$updateGroupId:"UploadGroup"})}}}if(r){await this._updateDraftWithContent(this._binding.getPath(),r,r.type,r.name,o)}await this._activateDraft(this._binding.getPath(),o);a.success("File uploaded successfully.");this._editBindingContext=null;this._resetForm();this.onCloseDialog()}catch(e){a.error("Error during upload process: "+e.message)}},_fetchCSRFToken:function(){var e=sap.ui.require.toUrl("admindash").split("/resources")[0];if(e==="."){e=""}return fetch(e+"/odata/v4/media/",{method:"GET",headers:{"X-CSRF-Token":"Fetch"},credentials:"include"}).then(e=>{if(!e.ok)throw new Error("Failed to fetch CSRF token");this.getView().getModel("ui").setProperty("/csrfToken",e.headers.get("x-csrf-token"))}).catch(e=>console.error("Error fetching CSRF token: ",e))},_validateUploadInputs:function(e,t,r,i){if(!e)return a.error("Please enter a Manufacturer Number."),false;if(!t)return a.error("Please enter an MFG Name."),false;if(!r&&!i)return a.error("Please choose a file to upload."),false;return true},_resetForm:function(){var e=this.getView().getModel("ui");this.byId("fileUploader").clear();e.setProperty("/fileData",null);e.setProperty("/manufacturerNumber","");e.setProperty("/mfgName","");this.getView().getModel().refresh();this._binding=null;this.byId("idMediaFilesTable").removeSelections(true)},_createDraft:function(e,t,r,i,a){var n=sap.ui.require.toUrl("admindash").split("/resources")[0];if(n==="."){n=""}return fetch(n+"/odata/v4/media/MediaFile",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":a},credentials:"include",body:JSON.stringify({manufacturerNumber:e,MFGName:t,fileName:r,mediaType:i})}).then(e=>e.json()).then(e=>({context:{getPath:()=>`/MediaFile(ID=${e.ID},IsActiveEntity=false)`}})).catch(e=>{throw new Error("Failed to create draft: "+e.message)})},_updateDraftWithContent:async function(e,t,r,i,n){try{const a=await fetch(this._oModel.sServiceUrl+e+"/content",{method:"PUT",headers:{"X-CSRF-Token":n,"Content-Type":r,slug:i},credentials:"include",body:t});console.log("Server Response Status:",a.status);if(!a.ok){throw new Error(`Failed to upload file. Server responded with status: ${a.status}`)}let o=null;let s=null;if(a.status===204){console.warn("Server returned 204 No Content. Constructing file URL manually...")}else{const e=await a.text();console.log("Raw server response:",e);if(e){try{const t=JSON.parse(e);s=t?.ID}catch(e){console.warn("Response is not valid JSON.")}}}let l=e.replace("IsActiveEntity=false","IsActiveEntity=true");o=this._oModel.sServiceUrl+l+"/content";console.log("Final file URL:",o);this.getView().getModel("ui").setProperty("/fileData/fileUrl",o);const u=await fetch(this._oModel.sServiceUrl+e,{method:"PATCH",headers:{"X-CSRF-Token":n,"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({url:o})});if(!u.ok){throw new Error(`Failed to update file URL in backend. Status: ${u.status}`)}console.log("✅ File URL successfully updated in backend.")}catch(e){console.error("Upload error:",e.message);a.error("Upload error: "+e.message)}},_activateDraft:function(e,t){debugger;var r=sap.ui.require.toUrl("admindash").split("/resources")[0];if(r==="."){r=""}return fetch(`${r}/odata/v4/media${e}/Media.draftActivate`,{method:"POST",headers:{"X-CSRF-Token":t,"Content-Type":"application/json"},credentials:"include"}).then(e=>{if(!e.ok)throw new Error("Failed to activate draft")}).catch(e=>{throw new Error("Error activating draft: "+e.message)})},onTypeMissmatch:function(){a.error("Invalid file type. Allowed types are: txt, pdf, docx, jpg, png, jpeg")},onManufacturerNumberLiveChange:function(e){var t=e.getParameter("value");var r=e.getSource();var i=this.getView().getModel("ui");var a=i.getProperty("/existingManufacturers");if(/[a-zA-Z]/.test(t)){r.setValueState("Error");r.setValueStateText("Manufacturer Number should not contain letters.")}else{r.setValueState("None")}if(a.includes(t)){r.setValueState("Error");r.setValueStateText("This Manufacturer Number already exists.")}else{r.setValueState("None")}},onManufacturerNameLiveChange:function(e){var t=e.getParameter("value");var r=e.getSource();var i=this.getView().getModel("ui");var a=i.getProperty("/existingMfgNames").map(e=>e.toLowerCase());if(a.includes(t)){r.setValueState("Error");r.setValueStateText("This Manufacturer Name already exists.")}else{r.setValueState("None")}},onDeleteDraft:function(){var e=this.byId("idMediaFilesTable");var t=e.getSelectedItems();if(!t.length){a.warning("Please select at least one draft to delete.");return}a.warning("Make sure ONLY entries you want to delete are selected. Once deleted, this action cannot be undone.",{actions:[a.Action.OK,a.Action.CANCEL],emphasizedAction:a.Action.OK,onClose:e=>{if(e===a.Action.OK){this._deleteDrafts(t)}}})},_deleteDrafts:function(e){var r=this.getView().getModel();var i=[];e.forEach(e=>{var t=e.getBindingContext();i.push(t.delete())});Promise.all(i).then(()=>{t.show("Selected items deleted successfully.");r.refresh()}).catch(e=>{a.error("Error deleting items: "+e.message)})}})});
},
	"admindash/i18n/i18n.properties":'# This is the resource bundle for admindash\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=Manufacturer Profile Manager\n\n#YDES: Application description\nappDescription=An SAP Fiori application.\n#XTIT: Main view title\ntitle=Manufacturer Profile Manager\n\n#XFLD,45\nflpTitle=Manufacturer Profile Manager\nflpSubTitle=Upload logos and maintain manufacturer details\nflpIcon=sap-icon://factory\n\nmanufacturerNumberError=Manufacturer Number cannot contain letters.\n\n\nuploadPageTitle=Manufacturer Profile Manager\nfileUploaderPlaceholder=Choose a file...\nuploadButtonText=Upload\n\nmanufacturerNumberLabel=Manufacturer Number\nmanufacturerNumberPlaceholder=Enter Manufacturer Number\nmfgNameLabel=MFG Name\nmfgNamePlaceholder=Enter MFG Name\nmfgUploadLabel=Upload Logo\n',
	"admindash/manifest.json":'{"_version":"1.65.0","sap.app":{"id":"admindash","type":"application","i18n":"i18n/i18n.properties","applicationVersion":{"version":"0.0.2"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.16.3","toolsId":"97e56c45-d7a2-46fa-8971-7bf494c123ff"},"dataSources":{"mainService":{"uri":"/odata/v4/media/","type":"OData","settings":{"annotations":[],"odataVersion":"4.0"}}},"crossNavigation":{"inbounds":{"Dashboard-display":{"semanticObject":"Dashboard","action":"display","title":"{{flpTitle}}","subTitle":"{{flpSubTitle}}","icon":"{{flpIcon}}","signature":{"parameters":{},"additionalParameters":"allowed"}}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":true,"dependencies":{"minUI5Version":"1.132.1","libs":{"sap.m":{},"sap.ui.core":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"admindash.i18n.i18n"}},"":{"dataSource":"mainService","preload":true,"settings":{"operationMode":"Server","autoExpandSelect":true,"earlyRequests":true}}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","controlAggregation":"pages","controlId":"app","transition":"slide","type":"View","viewType":"XML","path":"admindash.view"},"routes":[{"name":"RouteView1","pattern":":?query:","target":["TargetView1"]}],"targets":{"TargetView1":{"id":"View1","name":"View1"}}},"rootView":{"viewName":"admindash.view.App","type":"XML","id":"App"}},"sap.cloud":{"public":true,"service":"mck.portal"}}',
	"admindash/model/formatter.js":function(){
sap.ui.define([],()=>{"use strict";return{formatUrl:function(e,t){if(!e)return"";const r=t!==false;var a=sap.ui.require.toUrl("admindash").split("/resources")[0];if(a==="."){a=""}console.log("✅ Dynamic Base Path:",a);var i=a+"/odata/v4/media/MediaFile";return`${i}(ID='${e}',IsActiveEntity=${r})/content`},formatModifiedAt:function(e,t){const r=sap.ui.core.format.DateFormat.getDateTimeInstance({style:"medium"});if(e){return r.format(new Date(e))}if(t){return"Created: "+r.format(new Date(t))}return"Not yet saved"}}});
},
	"admindash/model/models.js":function(){
sap.ui.define(["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
},
	"admindash/view/App.view.xml":'<mvc:View controllerName="admindash.controller.App"\n    displayBlock="true"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"><App id="app"></App></mvc:View>',
	"admindash/view/View1.view.xml":'<mvc:View controllerName="admindash.controller.View1"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:u="sap.ui.unified"\n    xmlns:form="sap.ui.layout.form"\n    xmlns:layout="sap.ui.layout"><Page id="uploadAdminPage" title="{i18n>uploadPageTitle}" showHeader="true"><content><HBox id="_IDGenHBox1" class="centeredTableBox" justifyContent="Center" width="100%"><VBox id="_IDGenVBox" width="100%" class="responsiveTableWrapper"><Table id="idMediaFilesTable"\n                width="100%"\n                inset="false"\n                mode="MultiSelect"\n                items="{\n                    path: \'/MediaFile\'\n                }"\n                busyIndicatorDelay="0"\n                busy="{ui>/isUploading}"\n                growing="true"\n                growingThreshold="20"\n                growingScrollToLoad="true"\n                ><headerToolbar><OverflowToolbar id="tableHeaderToolbar"><content><Title id="tableTitle" text="Manufacturer Logos" level="H2"/><ToolbarSpacer id="toolbarSpacer" /><Button id="openAddDialogButton" text="Add New Logo" press=".onOpenDialog" type="Emphasized" icon="sap-icon://add"/><Button id="editSelectedButton" text="Edit Selected" press=".onEditPress" type="Transparent" icon="sap-icon://edit"\n                                enabled="{= ${idMediaFilesTable>/selectedContexts}.length === 1 }"/><Button id="deleteSelectedButton" text="Delete Selected" press=".onDeleteDraft" type="Reject" icon="sap-icon://delete"\n                                enabled="{= ${idMediaFilesTable>/selectedContexts}.length > 0 }"/></content></OverflowToolbar></headerToolbar><columns><Column id="mfgNumberCol" width="15%"><Text id="mfgNumberColText" text="Man. Number" /></Column><Column id="mfgNameCol" width="20%"><Text id="mfgNameColText" text="Man. Name" /></Column><Column id="fileNameCol" minScreenWidth="Tablet" demandPopin="true" width="20%"><Text id="fileNameColText" text="File Name" /></Column><Column id="logoCol" hAlign="Center" width="15%"><Text id="logoColText" text="Logo" /></Column><Column id="modifiedAtCol" minScreenWidth="Desktop" demandPopin="true" hAlign="End" width="20%"><Text id="modifiedAtColText" text="Last Modified" /></Column></columns><items><ColumnListItem id="tableItemTemplate" vAlign="Middle" type="Navigation" press=".onListItemPress"><cells><Text id="itemMfgNumber" text="{manufacturerNumber}" /><Text id="itemMfgName" text="{MFGName}" /><Text id="itemFileName" text="{fileName}" /><Image \n                                core:require="{\n                                    Formatter: \'admindash/model/formatter\'\n                                }" \n                                id="logoImage" \n                                src="{\n                                    parts: [\n                                        { path: \'ID\' },\n                                        { path: \'IsActiveEntity\' }\n                                    ],\n                                    formatter: \'Formatter.formatUrl.bind($controller)\'\n                                }" \n                                alt="{fileName}" \n                                width="100px" \n                                densityAware="false"\n                                decorative="false"\n                                class="sapUiTinyMargin"\n                            /><Text id="itemModifiedAt" \n                                core:require="{\n                                    Formatter: \'admindash/model/formatter\'\n                                }"\n                                text="{\n                                parts: [\n                                    {path: \'modifiedAt\', targetType: \'any\'}, \n                                    {path: \'createdAt\', targetType: \'any\'}\n                                ], \n                                formatter: \'Formatter.formatModifiedAt.bind($controller)\'\n                            }" /></cells></ColumnListItem></items></Table></VBox></HBox><Dialog id="addManufacturerDialog" title="{= ${ui>/isEditMode} ? \'Edit Manufacturer Logo\' : \'Add New Manufacturer Logo\' }"\n                stretch="{= !${device>/system/desktop} }"\n                busyIndicatorDelay="0"\n                busy="{ui>/isUploading}"\n                class="sapUiResponsiveContentPadding"><content><form:SimpleForm id="addManufacturerForm" editable="true" layout="ResponsiveGridLayout"\n                        labelSpanXL="4" labelSpanL="3" labelSpanM="12" labelSpanS="12"\n                        adjustLabelSpan="false" emptySpanXL="0" emptySpanL="4" emptySpanM="0" emptySpanS="0"\n                        columnsXL="2" columnsL="1" columnsM="1" singleContainerFullSize="false"><form:content><core:Title id="detailsTitle" text="Details" /><Label id="mfgNumberLabel" text="Manufacturer Number" required="true"/><Input id="mfgNumberInput" value="{ui>/manufacturerNumber}" liveChange=".onManufacturerNumberLiveChange" placeholder="Enter unique manufacturer number"/><Label id="mfgNameLabel" text="Manufacturer Name" required="true"/><Input id="mfgNameInput" value="{ui>/mfgName}" liveChange=".onManufacturerNameLiveChange" placeholder="Enter manufacturer name"/><core:Title id="fileUploadTitle" text="File Upload" /><Label id="logoFileLabel" text="Logo File" required="true"/><u:FileUploader\n                                id="fileUploader"\n                                name="logoFile"\n                                fileType="png,jpg,jpeg,gif,svg"\n                                buttonText="Browse..."\n                                change="onChange"\n                                typeMissmatch="onFileTypeMismatch"\n                                style="Emphasized"\n                                icon="sap-icon://upload"\n                                tooltip="Select a logo file (PNG, JPG, GIF, SVG)"/><Label id="selectedFileLabel" text="Selected File" visible="{= !!${ui>/fileData/fileName}}"/><layout:HorizontalLayout id="_IDGenHorizontalLayout" visible="{= !!${ui>/fileData/fileName}}"><ObjectStatus id="selectedFileText" title="{ui>/fileData/fileName}" text="{ui>/fileData/fileSize}" state="Information"/></layout:HorizontalLayout></form:content></form:SimpleForm></content><beginButton><Button id="uploadButton" text="{= ${ui>/isEditMode} ? \'Save Changes\' : \'Upload &amp; Activate\' }" press=".onUploadPress" type="Emphasized" enabled="{= !${ui>/isUploading} &amp;&amp; !!${ui>/fileData} }"><layoutData><OverflowToolbarLayoutData id="_IDGenOverflowToolbarLayoutData1" priority="NeverOverflow"/></layoutData></Button></beginButton><endButton><Button id="cancelButton" text="Cancel" press=".onCloseDialog" enabled="{= !${ui>/isUploading} }"><layoutData><OverflowToolbarLayoutData id="_IDGenOverflowToolbarLayoutData2" priority="NeverOverflow"/></layoutData></Button></endButton></Dialog></content></Page></mvc:View>'
});
//# sourceMappingURL=Component-preload.js.map
